[{name:'IPsec',title:'IPsec',group:'IP',c:[{name:'IPsec Policy',title:'Policies',type:'map',path:[ 85,1 ],autorefresh:2000,nameval:{type:'concat',first:{type:'concat',first:'Src. Address',second:'Src. Port',sep:':'},second:{type:'concat',first:'Dst. Address',second:'Dst. Port',sep:':'},sep:'->'},ordered:1,refetchonchange:1,c:[{name:'General',type:'tab'},{name:'Peer',type:'multinumber',id:'U1f',max:2,on:'nopeer',width:100,c:[{type:'enm',values:{type:'dynamic',path:[ 85,4 ]}}]},{name:'Tunnel',type:'bool',id:'bb',on:'notemplate',width:40},{name:'Src. Address',type:'union',single:1,width:120,c:[{type:'network',id:'u1',maskid:'u2'},{type:'network6',id:'a15',deflen:0,maskid:'u16'}]},{name:'Src. Port',type:'number',id:'u3',max:65535,opt:1,width:45},{name:'Dst. Address',type:'union',single:1,width:120,c:[{type:'network',id:'u4',maskid:'u5'},{type:'network6',id:'a17',deflen:0,maskid:'u18'}]},{name:'Dst. Port',type:'number',id:'u6',max:65535,opt:1,width:45},{name:'Protocol',type:'number',id:'u7',def:255,max:255,min:1,values:{type:'static',map:{1:'icmp',2:'igmp',3:'ggp',4:'ip-encap',6:'tcp',8:'egp',17:'udp',50:'ipsec',255:'all'}},width:40},{type:'separator'},{name:'Template',type:'bool',id:'b1c'},{name:'Group',type:'enm',id:'u1b',on:'template',values:{type:'dynamic',path:[ 85,10 ]}},{name:'Action',type:'tab'},{name:'Action',type:'enm',id:'u11',def:2,values:{type:'static',map:{0:'discard',1:'none',2:'encrypt'}},width:50},{name:'Level',type:'enm',id:'u12',def:2,on:'notemplate',values:{type:'static',map:{1:'use',2:'require',3:'unique'}},width:50},{name:'IPsec Protocols',type:'enm',id:'u9',def:2,values:{type:'static',map:[ '','ah','esp' ]}},{name:'Proposal',type:'enm',id:'uf',values:{type:'dynamic',path:[ 85,7 ]}},{name:'Status',type:'tab'},{name:'PH2 Count',type:'number',id:'u1d',opt:1,ro:1},{name:'PH2 State',type:'enm',id:'u65',def:4294967295,opt:1,ro:1,values:{type:'static',map:['spawning','starting','ready to send','getspi sent','getspi done','msg1 sent','ready to establish','commiting','adding sa','established','expired','no phase2']},width:60},{name:'SA Src. Address',type:'union',ro:1,single:1,c:[{type:'ipaddr',id:'uc'},{type:'ip6addr',id:'a19'}]},{name:'SA Dst. Address',type:'union',ro:1,single:1,c:[{type:'ipaddr',id:'ud'},{type:'ip6addr',id:'a1a'}]},{type:'enable'},{type:'invalid'},{type:'dynamic'},{type:'comment'},{type:'preset'},{name:'Template',type:'flag',id:'b1c',hint:'T',nofilter:1},{name:'Active',type:'flag',id:'b8',hint:'A'},{name:'template',type:'cond',hidedynamicly:1,c:[{on:'Template',pred:{type:'bool',value:1}}]},{name:'notemplate',type:'cond',hidedynamicly:1,c:[{on:'Template',pred:{type:'bool',value:0}}]},{name:'nopeer',type:'cond',hidedynamicly:1,c:[{on:'Template',pred:{type:'bool',value:0}},{on:'Action',pred:{type:'number',value:[ 2 ]}}]}]},{title:'Statistics',type:'item',path:[ 85,8 ],autorefresh:1000,ro:1,c:[{name:'In',type:'tab'},{name:'Errors',type:'number',id:'u1'},{name:'Buffer Errors',type:'number',id:'u2'},{name:'Header Errors',type:'number',id:'u3'},{type:'separator'},{name:'No States',type:'number',id:'u4'},{name:'State Protocol Errors',type:'number',id:'u5'},{name:'State Mode Errors',type:'number',id:'u6'},{name:'State Sequence Errors',type:'number',id:'u7'},{name:'State Expired',type:'number',id:'u8'},{name:'State Mismatches',type:'number',id:'u9'},{name:'State Invalid',type:'number',id:'ua'},{type:'separator'},{name:'Template Mismatches',type:'number',id:'ub'},{name:'No Policies',type:'number',id:'uc'},{name:'Policy Blocked',type:'number',id:'ud'},{name:'Policy Errors',type:'number',id:'ue'},{name:'Out',type:'tab'},{name:'Errors',type:'number',id:'uf'},{name:'Bundle Errors',type:'number',id:'u10'},{name:'Bundle Check Errors',type:'number',id:'u11'},{type:'separator'},{name:'No States',type:'number',id:'u12'},{name:'State Protocol Errors',type:'number',id:'u13'},{name:'State Mode Errors',type:'number',id:'u14'},{name:'State Sequence Errors',type:'number',id:'u15'},{name:'State Expired',type:'number',id:'u16'},{type:'separator'},{name:'Policy Blocked',type:'number',id:'u17'},{name:'Policy Dead',type:'number',id:'u18'},{name:'Policy Errors',type:'number',id:'u19'}]},{name:'IPsec Proposal',title:'Proposals',type:'map',path:[ 85,7 ],nameval:'Name',prefix:'proposal',c:[{name:'Name',type:'string',id:'s1',min:1,width:65},{name:'Auth. Algorithms',type:'set',id:'u5',def:128,values:{type:'static',map:{6:'md5',7:'sha1',8:'null',14:'sha256',15:'sha512'}},width:120},{name:'Encr. Algorithms',type:'set',id:'u6',def:4,values:{type:'static',map:{0:'null',1:'des',2:'3des',3:'aes-128 cbc',4:'aes-192 cbc',5:'aes-256 cbc',9:'blowfish',10:'twofish',11:'camellia-128',12:'camellia-192',13:'camellia-256',16:'aes-128 ctr',17:'aes-192 ctr',18:'aes-256 ctr',19:'aes-128 gcm',20:'aes-192 gcm',21:'aes-256 gcm'}},width:120},{name:'Lifetime',type:'interval',id:'u2',def:1800,opt:1,width:60},{name:'PFS Group',type:'enm',id:'u4',values:{type:'defenum',defid:0,defname:'none',values:{type:'static',map:{1:'modp768',2:'modp1024',3:'ec2n155',4:'ec2n185',5:'modp1536',14:'modp2048',15:'modp3072',16:'modp4096',17:'modp6144',18:'modp8192',19:'ecp256',20:'ecp384',21:'ecp521'}}},width:65},{type:'enable'},{type:'preset'}]},{name:'IPsec Group',title:'Groups',type:'map',path:[ 85,10 ],nameval:'Name',prefix:'group',c:[{name:'Name',type:'string',id:'sfe0010',min:1,width:120},{type:'preset'}]},{name:'IPsec Peer',title:'Peers',type:'map',path:[ 85,4 ],nameval:'Name',ordered:1,prefix:'peer',c:[{name:'Name',type:'string',id:'sfe0010',min:1,width:100},{name:'Address',type:'union',opt:1,single:1,width:80,c:[{type:'network',id:'u1',maskid:'ud'},{type:'network6',id:'a17',deflen:0,maskid:'u18'},{type:'string',id:'s2f',min:1}]},{name:'Port',type:'number',id:'u2',max:65535,opt:1},{name:'Local Address',type:'union',opt:1,single:1,width:100,c:[{type:'ipaddr',id:'u24',opt:1},{type:'ip6addr',id:'a25'}]},{name:'Profile',type:'enm',id:'u30',values:{type:'dynamic',path:[ 85,13 ]},width:100},{name:'Exchange Mode',type:'enm',id:'u4',def:2,values:{type:'static',map:{1:'base',2:'main',4:'aggressive',8:'IKE2'}},width:65},{name:'Passive',type:'bool',id:'b23'},{name:'Send INITIAL_CONTACT',type:'bool',id:'b5',def:1},{type:'enable'},{type:'comment'},{type:'dynamic'},{name:'responder',type:'flag',id:'b23',hint:'R'},{type:'about'}]},{name:'IPsec Identity',title:'Identities',type:'map',path:[ 85,14 ],nameval:'Peer',nonmovable:1,ordered:1,c:[{name:'Peer',type:'enm',id:'u2',values:{type:'dynamic',path:[ 85,4 ]},width:100},{name:'Auth. Method',type:'enm',id:'u1',def:1,values:{type:'static',map:{1:'pre shared key',2:'rsa key',3:'digital signature',4:'pre shared key xauth',6:'rsa signature hybrid',7:'eap radius',8:'eap'}},width:80},{type:'separator'},{type:'deck',panes:[{vals:[ 3 ],c:[{name:'Certificate',type:'multinumber',id:'U8',max:200,c:[{type:'enm',values:{type:'dynamic',path:[ 19,1 ],pred:{type:'slot',pred:{type:'number',value:[ 1 ]},slot:'type'}}}]},{name:'Remote Certificate',type:'enm',id:'u9',values:{type:'defenum',defid:4294967295,defname:'none',values:{type:'dynamic',path:[ 19,1 ],pred:{type:'slot',pred:{type:'number',value:[ 1 ]},slot:'type'}}}}]},{vals:[ 1 ],c:[{name:'Secret',type:'secret',id:'s7'}]},{vals:[ 4 ],c:[{name:'Secret',type:'alias'},{type:'separator'},{name:'Username',type:'string',id:'sc',width:80},{name:'Password',type:'secret',id:'sd'}]},{vals:[ 6 ],c:[{name:'Certificate',type:'alias'},{name:'Remote Certificate',type:'alias'},{type:'separator'},{name:'Username',type:'alias'},{name:'Password',type:'alias'}]},{vals:[ 2 ],c:[{name:'Key',type:'enm',id:'ua',values:{type:'dynamic',path:[ 85,5 ]}},{name:'Remote Key',type:'enm',id:'ub',values:{type:'dynamic',path:[ 85,5 ]}}]},{vals:[ 7 ],c:[{name:'Certificate',type:'alias'}]},{vals:[ 8 ],c:[{name:'EAP Methods',type:'multinumber',id:'U17',max:200,c:[{type:'enm',values:{type:'static',map:{1:'TLS',2:'TTLS',3:'PEAP',4:'MS-CHAPv2'}}}]},{name:'Certificate',type:'alias'},{name:'Remote Certificate',type:'alias'},{type:'separator'},{name:'Username',type:'alias'},{name:'Password',type:'alias'}]}],selon:'Auth. Method'},{type:'separator'},{name:'Policy Template Group',type:'enm',id:'u3',values:{type:'dynamic',path:[ 85,10 ]}},{name:'Notrack Chain',type:'string',id:'s6',values:{type:'dynamic',path:[ 20,86 ]}},{type:'separator'},{name:'My ID Type',type:'enm',id:'ue',def:100,values:{type:'static',map:{1:'fqdn',2:'user fqdn',3:'key id',4:'address',5:'dn',100:'auto'}}},{type:'deck',panes:[{vals:[ 1,2,3 ],c:[{name:'My ID',type:'string',id:'s11'}]},{vals:[ 4 ],c:[{name:'My ID',type:'union',single:1,c:[{type:'ipaddr',id:'uf'},{type:'ip6addr',id:'a10'}]}]}],selon:'My ID Type'},{type:'separator'},{name:'Remote ID Type',type:'enm',id:'u12',def:100,values:{type:'static',map:{1:'fqdn',2:'user fqdn',3:'key id',100:'auto',101:'ignore'}}},{type:'deck',panes:[{vals:[ 1,2,3 ],c:[{name:'Remote ID',type:'string',id:'s15',width:100}]}],selon:'Remote ID Type'},{name:'Match By',type:'enm',id:'u16',def:100,values:{type:'static',map:{50:'certificate',100:'remote id'}}},{type:'separator'},{name:'Mode Configuration',type:'enm',id:'u5',def:4294967295,opt:1,values:{type:'dynamic',path:[ 85,6 ]},width:100},{name:'Generate Policy',type:'enm',id:'u4',values:{type:'static',map:{0:'no',1:'port override',2:'port strict'}}},{type:'dynamic'},{type:'about'},{type:'comment'},{type:'enable'}]},{name:'IPsec User Settings',title:'Settings',type:'item',path:[ 85,12 ],c:[{name:'XAuth Use Radius',type:'bool',id:'b1'},{name:'Radius Accounting',type:'bool',id:'b2'},{name:'Interim Update',type:'interval',id:'u3'}]},{name:'IPsec Profile',title:'Profiles',type:'map',path:[ 85,13 ],nameval:'Name',prefix:'profile',c:[{name:'Name',type:'string',id:'sfe0010',width:100},{name:'Hash Algorithms',type:'enm',id:'u2',def:2,values:{type:'static',map:{1:'md5',2:'sha1',4:'sha256',5:'sha384',6:'sha512'}},width:100},{name:'PRF Algorithms',type:'enm',id:'ub',values:{type:'static',map:{0:'auto',2:'sha1',4:'sha256',5:'sha384',6:'sha512'}}},{name:'Encryption Algorithm',type:'set',id:'u1',def:12,values:{type:'static',map:['','des','3des','aes-128','aes-192','aes-256','blowfish','camellia-128','camellia-192','camellia-256']},width:120},{name:'DH Group',type:'set',id:'u3',def:16388,values:{type:'static',map:{1:'modp768',2:'modp1024',3:'ec2n155',4:'ec2n185',5:'modp1536',14:'modp2048',15:'modp3072',16:'modp4096',17:'modp6144',18:'modp8192',19:'ecp256',20:'ecp384',21:'ecp521'}},width:120},{type:'separator'},{name:'Proposal Check',type:'enm',id:'u4',def:1,values:{type:'static',map:[ '','obey','strict','claim','exact' ]},width:70},{name:'Lifetime',type:'interval',id:'u5',def:86400},{name:'Lifebytes',type:'number',id:'u6',opt:1},{type:'separator'},{name:'NAT Traversal',type:'bool',id:'b7',def:1},{name:'DPD Interval',type:'enm',id:'u8',def:120,postfix:'s',values:{type:'static',map:[ 'disable DPD' ]},c:[{type:'number',max:3600}]},{name:'DPD Maximum Failures',type:'number',id:'u9',def:5,max:100,min:1},{type:'preset'}]},{name:'IPsec Remote Peer',title:'Active Peers',type:'map',path:[ 85,9 ],autorefresh:1000,nameval:'Remote Address',refreshfilter:2,removable:1,ro:1,c:[{name:'ID',type:'string',id:'sfe0010',width:80},{type:'statusbar',c:[{name:'State',type:'enm',id:'u4',values:{type:'static',map:['spawning','starting','message 1 received','message 1 sent','message 2 received','message 2 sent','message 3 received','message 3 sent','message 4 received','established','expired','no phase1','eap']},width:80}]},{name:'Local Address',type:'union',single:1,width:95,c:[{type:'ipaddr',id:'u1'},{type:'ip6addr',id:'a9'}]},{name:'Local Port',type:'number',id:'uc'},{name:'Remote Address',type:'union',single:1,width:95,c:[{type:'ipaddr',id:'u2'},{type:'ip6addr',id:'aa'}]},{name:'Remote Port',type:'number',id:'ud'},{name:'Dynamic Address',type:'ipaddr',id:'ub',width:95},{type:'separator'},{name:'Side',type:'enm',id:'b5',opt:1,ro:1,values:{type:'static',map:[ 'initiator','responder' ]},width:65},{name:'Uptime',type:'age',id:'u6',opt:1,ro:1,width:100},{name:'Last Seen',type:'age',id:'uf',opt:1,ro:1},{name:'PH2 Total',type:'number',id:'u7',opt:1,ro:1,width:65},{type:'separator'},{name:'Tx/Rx Bytes',type:'tuple',separate:1,c:[{name:'Tx Bytes',type:'bigdecimal',id:'q11',ro:1,width:80},{name:'Rx Bytes',type:'bigdecimal',id:'q10',ro:1,width:80}]},{name:'Tx/Rx Packets',type:'tuple',separate:1,c:[{name:'Tx Packets',type:'bigdecimal',id:'q13',ro:1,width:80},{name:'Rx Packets',type:'bigdecimal',id:'q12',ro:1,width:80}]},{type:'comment'},{name:'Kill Connections',type:'doit',cmd:1}]},{name:'IPsec Mode Config',title:'Mode Configs',type:'map',path:[ 85,6 ],nameval:'Name',prefix:'cfg',c:[{name:'Name',type:'string',id:'sfe0010',min:1,width:100},{name:'Responder',type:'bool',id:'bb',width:45},{type:'separator'},{name:'Address Pool',type:'enm',id:'u1',def:4294967295,on:'resp',opt:1,values:{type:'dynamic',path:[ 84,2 ]},width:100},{name:'Address',type:'ipaddr',id:'uc',on:'resp',opt:1,width:100},{name:'Address Prefix Length',type:'number',id:'u2',def:24,max:32,min:1,on:'pool',width:80},{name:'Split Include',type:'multi',id:'M3',max:200,on:'resp',width:120,c:[{type:'network',id:'u4',maskid:'u5'}]},{name:'Split DNS',type:'multistring',id:'Se',max:200,on:'resp',c:[{type:'string'}]},{name:'System DNS',type:'bool',id:'b6',on:'resp',width:60},{name:'Static DNS',type:'multi',id:'M7',max:200,on:'sdns',c:[{type:'union',single:1,c:[{type:'ipaddr',id:'u8'}]}]},{name:'Connection Mark',type:'string',id:'sd',on:'nonresp',sorted:1,values:{type:'dynamic',path:[ 20,14 ]},width:60},{name:'Src. Address List',type:'string',id:'sa',on:'nonresp',sorted:1,values:{type:'dynamic',path:[ 20,34 ]},width:60},{name:'Use Responder DNS',type:'enm',id:'uf',def:2,on:'nonresp',values:{type:'static',map:{0:'no',1:'yes',2:'exclusively'}}},{type:'preset'},{name:'pool',type:'cond',hidedynamicly:1,c:[{on:'Address Pool',pred:{type:'not',pred:{type:'number',value:[ 4294967295 ]}}},{on:'Responder',pred:{type:'bool',value:1}}]},{name:'sdns',type:'cond',hidedynamicly:1,c:[{on:'System DNS',pred:{type:'bool',value:0}}]},{name:'resp',type:'cond',hidedynamicly:1,c:[{on:'Responder',pred:{type:'bool',value:1}}]},{name:'nonresp',type:'cond',hidedynamicly:1,c:[{on:'Responder',pred:{type:'bool',value:0}}]}]},{name:'IPsec SA',title:'Installed SAs',type:'map',path:[ 85,2 ],autorefresh:2000,nameval:{type:'concat',first:'Src. Address',second:'Dst. Address',sep:'->'},ro:1,c:[{name:'General',type:'tab'},{name:'SPI',type:'number',id:'u1',radix:16,width:75},{name:'Src. Address',type:'union',single:1,width:80,c:[{type:'ipaddr',id:'u7'},{type:'ip6addr',id:'a1c'}]},{name:'Src. Port',type:'number',id:'u1f'},{name:'Dst. Address',type:'union',single:1,width:80,c:[{type:'ipaddr',id:'u8'},{type:'ip6addr',id:'a1d'}]},{name:'Dst. Port',type:'number',id:'u20'},{name:'Replay',type:'number',id:'u2'},{name:'Encryption',type:'tab'},{name:'Auth. Algorithm',type:'enm',id:'u4',opt:1,values:{type:'static',map:{0:'none',2:'md5',3:'sha1',5:'sha256',7:'sha512'}},width:40},{name:'Encr. Algorithm',type:'enm',id:'u5',opt:1,values:{type:'static',map:{0:'none',2:'des',3:'3des',7:'blowfish',11:'null',12:'aes cbc',13:'aes ctr',20:'aes gcm',22:'camellia',253:'twofish'}},width:40},{name:'Encr. Key Size',type:'number',id:'ub',opt:1,width:40},{name:'Auth. Key',type:'secret',id:'sc'},{name:'Encr. Key',type:'secret',id:'se'},{name:'Expires',type:'tab'},{name:'Expires In',type:'interval',id:'u1e'},{name:'Add Lifetime',type:'tuple',c:[{type:'interval',id:'u14'},{type:'interval',id:'u17'}]},{type:'separator'},{name:'Current Addtime',type:'dateandtime',id:'u11',opt:1},{name:'Current Bytes',type:'bignumber',id:'q13',width:60},{type:'statusbar',c:[{type:'enm',id:'u3',values:{type:'static',map:[ 'larval','mature','dying','dead' ]}}]},{type:'numflag',id:'uf',c:{2:[ 'AH','A' ],3:[ 'ESP','E' ]}},{name:'Hardware AEAD',type:'flag',id:'b6',hint:'H'},{name:'Flush',type:'doit',cmd:1,global:1,c:[{name:'SA Type',type:'enm',id:'uf',compact:1,radio:1,values:{type:'static',map:[ 'all','','AH','ESP' ]}}]}]},{name:'IPsec Key',title:'Keys',type:'map',path:[ 85,5 ],nameval:'Name',nonaddable:1,prefix:'key',removable:1,c:[{name:'Name',type:'string',id:'sfe0010',min:1,width:100},{name:'Key Size',type:'number',id:'u1',postfix:'bits',ro:1,width:60},{name:'private key',type:'flag',id:'bb',hint:'P'},{name:'rsa',type:'flag',id:'bc',hint:'R'},{name:'Import',type:'doit',cmd:3,global:1,c:[{name:'File Name',type:'string',id:'s1',strict:1,values:{type:'dynamic',path:[ 72 ],pred:{type:'slot',pred:{type:'number',value:[ 1 ]},slot:'family'}}},{name:'Name',type:'string',id:'sfe0010'},{name:'Passphrase',type:'secret',id:'s2'}]},{name:'Export Pub. Key',type:'doit',cmd:2,global:1,c:[{name:'Key',type:'enm',id:'ufe0001',values:{type:'dynamic',path:[ 85,5 ]}},{name:'File Name',type:'string',id:'s1',min:1}]},{name:'Generate Key',type:'doit',cmd:1,global:1,c:[{name:'Name',type:'string',id:'sfe0010',min:1},{name:'Key Size',type:'enm',id:'u1',values:{type:'static',map:{1024:'1024',2048:'2048',4096:'4096'}}}]}]}]},{name:'SSH',title:'SSH',group:'IP',c:[{name:'SSH Settings',title:'SSH',type:'item',path:[ 8,2 ],c:[{name:'Forwarding Enabled',type:'enm',id:'u8',values:{type:'static',map:[ 'no','local','remote','both' ]}},{name:'Always Allow Password Login',type:'bool',id:'b2'},{name:'Strong Crypto',type:'bool',id:'b3'},{name:'Allow None Crypto',type:'bool',id:'b7'},{name:'Host Key Size',type:'enm',id:'u4',values:{type:'static',map:{1024:'1024',1536:'1536',2048:'2048',4096:'4096',8192:'8192'}}},{name:'Regenerate Host Key',type:'doit',cmd:3,confirm:'This will regenerate current SSH host keys,yes?'},{name:'Export Host Key',type:'doit',cmd:4,global:1,c:[{name:'Key File Prefix',type:'string',id:'sa',min:1}]},{name:'Import Host Key',type:'doit',cmd:5,confirm:'This will replace current SSH host key,yes?',global:1,c:[{name:'Private Key File',type:'string',id:'sc',min:1,values:{type:'dynamic',path:[ 72 ]}}]}]}]}]